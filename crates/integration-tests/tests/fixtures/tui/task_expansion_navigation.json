{
  "name": "Task Expansion and Navigation",
  "description": "Tests expanding/collapsing tasks with steps using Enter key in task pane",
  "tags": [
    "tui",
    "navigation",
    "task_tree",
    "keyboard"
  ],
  "setup": {
    "terminal_size": [
      100,
      30
    ]
  },
  "events": [
    {
      "type": "user_input",
      "data": {
        "text": "Create a multi-step task",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {},
        "ui": {
          "tasks_displayed": 1
        }
      },
      "strategy": {
        "type": "sequence",
        "responses": [
          {
            "typescript": [
              "async function agent_code(): Promise<any> {",
              "  return {",
              "    title: 'Multi-step task',",
              "    steps: [",
              "      {",
              "        title: 'Step 1',",
              "        description: 'Step 1: Initialize',",
              "        step_type: 'implementation'",
              "      },",
              "      {",
              "        title: 'Step 2',",
              "        description: 'Step 2: Process',",
              "        step_type: 'implementation'",
              "      },",
              "      {",
              "        title: 'Step 3',",
              "        description: 'Step 3: Finalize',",
              "        step_type: 'implementation'",
              "      }",
              "    ]",
              "  };",
              "}"
            ]
          },
          {
            "typescript": [
              "async function agent_code(): Promise<string> {",
              "  return 'Step 1 completed';",
              "}"
            ]
          },
          {
            "typescript": [
              "async function agent_code(): Promise<string> {",
              "  return 'Step 2 completed';",
              "}"
            ]
          },
          {
            "typescript": [
              "async function agent_code(): Promise<string> {",
              "  return 'Step 3 completed';",
              "}"
            ]
          }
        ]
      }
    },
    {
      "type": "key_press",
      "data": {
        "key": "t",
        "modifiers": [
          "ctrl"
        ]
      },
      "verify": {
        "ui": {
          "focused_pane": "tasks"
        }
      }
    },
    {
      "type": "key_press",
      "data": {
        "key": "Enter"
      },
      "verify": {
        "ui": {
          "task_tree_expanded": true
        }
      }
    },
    {
      "type": "key_press",
      "data": {
        "key": "Down"
      },
      "verify": {
        "ui": {}
      }
    },
    {
      "type": "key_press",
      "data": {
        "key": "Up"
      },
      "verify": {
        "ui": {}
      }
    },
    {
      "type": "key_press",
      "data": {
        "key": "Enter"
      },
      "verify": {
        "ui": {}
      }
    }
  ],
  "final_verify": {
    "execution": {},
    "ui": {
      "all_tasks_completed": true
    }
  }
}
