{
  "name": "Task List Complex Navigation",
  "description": "Tests complex task list navigation with multiple conversations, expansion, and scrolling",
  "config": {
    "terminal_size": [80, 30],
    "enable_vector_cache": false
  },
  "initial_state": {
    "workspace_files": [],
    "existing_tasks": [
      {"description": "First conversation", "status": "Completed", "children": [
        {"description": "First message in conv1", "status": "Completed"},
        {"description": "Second message in conv1", "status": "Completed"}
      ]},
      {"description": "Second conversation", "status": "Completed"},
      {"description": "Third conversation", "status": "Completed", "children": [
        {"description": "First message in conv3", "status": "Completed"}
      ]},
      {"description": "Fourth conversation", "status": "Completed"}
    ],
    "vector_cache_state": "complete"
  },
  "steps": [
    {
      "step": 1,
      "description": "Focus Tasks pane - should show last 3 conversations with expand indicators",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Tab"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step1.txt",
          "focused_pane": "Tasks"
        }
      }
    },
    {
      "step": 2,
      "description": "Navigate up from placeholder to Fourth conversation (newest)",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Up"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step2.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Fourth conversation",
          "expanded_conversations": []
        }
      }
    },
    {
      "step": 3,
      "description": "Navigate up to Third conversation",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Up"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step3.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Third conversation",
          "expanded_conversations": []
        }
      }
    },
    {
      "step": 4,
      "description": "Navigate up to Second conversation",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Up"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step4.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Second conversation"
        }
      }
    },
    {
      "step": 5,
      "description": "Try to expand Second conversation (has no children)",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Enter"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step5.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Second conversation",
          "expanded_conversations": ["Second conversation"]
        }
      }
    },
    {
      "step": 6,
      "description": "Navigate up to First conversation (oldest, should scroll)",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Up"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step6.txt",
          "focused_pane": "Tasks",
          "active_task_id": "First conversation",
          "expanded_conversations": ["Second conversation"]
        }
      }
    },
    {
      "step": 7,
      "description": "Expand First conversation (has children)",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Enter"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step7.txt",
          "focused_pane": "Tasks",
          "active_task_id": "First conversation",
          "expanded_conversations": ["First conversation", "Second conversation"]
        }
      }
    },
    {
      "step": 8,
      "description": "Navigate down to first child of First conversation",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Down"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step8.txt",
          "focused_pane": "Tasks",
          "active_task_id": "First message in conv1",
          "expanded_conversations": ["First conversation", "Second conversation"]
        }
      }
    },
    {
      "step": 9,
      "description": "Navigate down to second child of First conversation",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Down"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step9.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Second message in conv1",
          "expanded_conversations": ["First conversation", "Second conversation"]
        }
      }
    },
    {
      "step": 10,
      "description": "Navigate down to Second conversation (after children)",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Down"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step10.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Second conversation",
          "expanded_conversations": ["First conversation", "Second conversation"]
        }
      }
    },
    {
      "step": 11,
      "description": "Navigate up to second child of First conversation",
      "action": {
        "type": "key_press",
        "data": {
          "key": "Up"
        }
      },
      "expectations": {
        "ui_state": {
          "snapshot": "ui_task_list_complex_navigation_step11.txt",
          "focused_pane": "Tasks",
          "active_task_id": "Second message in conv1",
          "expanded_conversations": ["First conversation", "Second conversation"]
        }
      }
    }
  ]
}
