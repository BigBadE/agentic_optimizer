{
  "name": "Validation Stages Detailed Testing",
  "description": "Tests individual validation stages with various code samples and scenarios",
  "tags": [
    "validation",
    "stages",
    "syntax",
    "build",
    "test",
    "lint"
  ],
  "setup": {
    "files": {},
    "terminal_size": [
      80,
      24
    ]
  },
  "events": [
    {
      "type": "user_input",
      "data": {
        "text": "Test syntax validation with valid Rust code",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {},
        "files": [
          {
            "path": "src/hello.rs",
            "exists": true,
            "contains": [
              "pub fn hello",
              "String::from"
            ]
          }
        ]
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "syntax validation with valid",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  const validRust = `",
            "pub fn hello() -> String {",
            "    String::from(\\\"Hello, world!\\\")",
            "}",
            "`;",
            "  await writeFile('src/hello.rs', validRust);",
            "  return 'Valid Rust code written';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test build validation stage basic operation",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "build validation stage",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Build stage test';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test test validation stage",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "test validation stage",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Test stage verification';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test lint validation stage",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "lint validation stage",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Lint stage test';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test validation stages can run independently",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "stages can run independently",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Independent stage execution';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test validation with file changes",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {},
        "files": [
          {
            "path": "src/test.rs",
            "exists": true,
            "contains": [
              "pub fn test"
            ]
          }
        ]
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "validation with file changes",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  await writeFile('src/test.rs', 'pub fn test() {}');",
            "  return 'File changes validated';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test validation with multiple file changes",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {},
        "files": [
          {
            "path": "src/module1.rs",
            "exists": true
          },
          {
            "path": "src/module2.rs",
            "exists": true
          },
          {
            "path": "src/module3.rs",
            "exists": true
          }
        ]
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "multiple file changes",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  await writeFile('src/module1.rs', 'pub fn func1() {}');",
            "  await writeFile('src/module2.rs', 'pub fn func2() {}');",
            "  await writeFile('src/module3.rs', 'pub fn func3() {}');",
            "  return 'Multiple files created';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test validation result structure",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "validation result structure",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Structure test';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test validation stage ordering",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "stage ordering",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Stage order test';",
            "}"
          ]
        }
      }
    },
    {
      "type": "user_input",
      "data": {
        "text": "Test quick check functionality",
        "submit": true
      }
    },
    {
      "type": "llm_response",
      "verify": {
        "execution": {}
      },
      "strategy": {
        "type": "once",
        "trigger": {
          "pattern": "quick check functionality",
          "match_type": "contains"
        },
        "response": {
          "typescript": [
            "async function agent_code(): Promise<string> {",
            "  return 'Quick checks complete';",
            "}"
          ]
        }
      }
    }
  ],
  "final_verify": {
    "execution": {},
    "files": [
      {
        "path": "src/hello.rs",
        "exists": true
      },
      {
        "path": "src/test.rs",
        "exists": true
      },
      {
        "path": "src/module1.rs",
        "exists": true
      },
      {
        "path": "src/module2.rs",
        "exists": true
      },
      {
        "path": "src/module3.rs",
        "exists": true
      }
    ]
  }
}
